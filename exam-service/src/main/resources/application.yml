server:
  port: 8082

spring:
  application:
    name: exam-service

  datasource:
    url: jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:certi-master}
    username: ${DB_USERNAME:postgres}
    password: ${DB_PASSWORD:postgres}
    driver-class-name: org.postgresql.Driver
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000

  jpa:
    hibernate:
      ddl-auto: none
    show-sql: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect

# Kafka Configuration
  kafka:
    bootstrap-servers: ${KAFKA_BOOTSTRAP_SERVERS:localhost:29092,localhost:29093,localhost:29094}
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.springframework.kafka.support.serializer.JsonSerializer
    consumer:
      group-id: exam-service-group
      auto-offset-reset: earliest
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: org.springframework.kafka.support.serializer.JsonDeserializer
      properties:
        spring.json.trusted.packages: com.certimaster.*
    admin:
      auto-create: true

# JWT Configuration - RS256 Algorithm (must match auth-service)
# For production, use the same RSA keys as auth-service
jwt:
  # Access token expiration: 15 minutes
  access-token-expiration: 900000
  # Refresh token expiration: 7 days
  refresh-token-expiration: 604800000
  # JWT issuer for token validation (must match auth-service)
  issuer: certimaster-auth
  # RSA keys (Base64 encoded) - must be the same as auth-service
  private-key: ${JWT_PRIVATE_KEY:MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDZXTG+LLRSUiZp+xFKQ5JZj7gLixtpb8hemwp8uJm9Z32RbBWIuMl7IRS2/WoKOy+jSKjJyrrp2qEbsCZkfKX13MDea3FnnaBIC0hAfW8RV1sai+QCvDwvgl3iik4wX+XOChwK4MW+HZSKXMLfMhbeGhSax0FwDZNmbS2vK03G9LrPqW1679OiV8qEtRBBF9XF+FRgXQ5UxHDH21f4s+lPnW6JagywhZOjgQxI65pMD7utBIMhTLcv15ZkwqEKRsEkRDc3p8gGZa2wej7K8zG1hFz32vG0HXDqMMkfJC9/vxk8+ssScXyGMsAGEVfhbTC7VkU8UAux/cV1lFo4yAndAgMBAAECggEAFYd+zA6a/LVg0yn4RDINrpvG17PbTvXws3gpUYGqTqGPxSXeuyhMYor8BYTzqhhDJ2nkt/oByfRq9TZdEyJqgL/xBYbAWIo7DC+75BFYfS/5GNfGyYOR9YW03WGkDXQOK7qCHQy24VYGNq8p6RgJvk14gX0fbOUXVrOVLQ69uSkpE3NRD/R0wHeNWJkv7sVRZCqxS7/Yll2/qmcd7OXxdj34CCriNAoFlsEZh0mti1FN1ZqkBo5R5TR3wz9tnbZO7eeO959Wsw7MfNd4mr5HB0MWnEBTr0d8TmMQRt92xgJcKWgKuYSNzzBMXDruvSKNYwJ0lCsISolS67XyhNPG6QKBgQDwvTdlt8CIZbCMs5bfpfE771IO1V9sSmqi2MUgT3jBtXRcE4JuoFuANebUx02uszLg+ZWX+6JafMIQERfgQlPcteE7gN0DE4ZmghOMSZ0uRx0RVeBvm4kkmlOCvlGoNkbTmm5Qs+tLApARcU8P1SK26TPORLxXOPwoKFKhxZVKVQKBgQDnJKPrI8HRCEmpxYqpe/mqRlVyD37vmJ5xyqepHOWt0jRC+TI6kyDLCgjUFBSTREZaoW5SZatKcuKIdTOEvdD4ZeNoR2Xnkbox6K/RIUe+90Hxb2b0XNHMPjibLoAO9q9PeVkYadn+2M6La9cxyulUgB7LJFqma5fLgG6uJ+FZaQKBgFj0EbwsIaBEsu/KjD0ne/PBgniorxG8jZqOrog51Uz+V3iOXOuzpRvCzwBghHvBC1PF5Vi7SkpVPv/g0Qm0eHhdXFQ4UXIJjOfjuIVlzgaDkGIPcVbMCejUfXcaC+Iz7AfUUF7RnGejEsjfLW+UObeMg+/7xfwUule8TowoDfnhAoGAOsBTcecq0oj6wE5XynCaqy8pdM5/g0MVsvLB3vhbYO03H3bbz4uqIDGywMVB3ZTTFSJHOmZhPZEqB2lS6QCeZyTuwoizXELsQtdUKSH+bInIlyer0ZzuLq36EWemYSdOtDKx9MSjBmXxSfrlPeDHohTWvufEqtxaPv2sJFQ6sVECgYEAyZ5WrIPhvKlL1sF1cHTD6Rfsaap9a7zmZme11bWm2z+wAKZyCG6e4xrU2+ppbG+XRnZIObKyU6TDxskGo7O3nXtJz21qYWtgnxv0YEgpQxs5SrBd0uw8STzQro7NY6QslJ6/iD6H31AkPHodugAHLRlvGrmv+H8a2Nq9V6MhyIw=}
  public-key: ${JWT_PUBLIC_KEY:MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA2V0xviy0UlImafsRSkOSWY+4C4sbaW/IXpsKfLiZvWd9kWwViLjJeyEUtv1qCjsvo0ioycq66dqhG7AmZHyl9dzA3mtxZ52gSAtIQH1vEVdbGovkArw8L4Jd4opOMF/lzgocCuDFvh2UilzC3zIW3hoUmsdBcA2TZm0trytNxvS6z6lteu/TolfKhLUQQRfVxfhUYF0OVMRwx9tX+LPpT51uiWoMsIWTo4EMSOuaTA+7rQSDIUy3L9eWZMKhCkbBJEQ3N6fIBmWtsHo+yvMxtYRc99rxtB1w6jDJHyQvf78ZPPrLEnF8hjLABhFX4W0wu1ZFPFALsf3FdZRaOMgJ3QIDAQAB}

# Logging
logging:
  level:
    root: INFO
    com.certimaster.auth_service: DEBUG
    org.springframework.security: DEBUG
    org.hibernate.SQL: DEBUG
    org.apache.kafka: WARN
    org.apache.kafka.clients.NetworkClient: ERROR
    org.springframework.kafka: WARN

# Actuator
management:
  endpoints:
    web:
      exposure:
        include: health,info,prometheus,metrics
  endpoint:
    health:
      show-details: always

# Exam Session Configuration
exam:
  session:
    reply-timeout-seconds: 30

# External Services
services:
  result-service:
    url: ${RESULT_SERVICE_URL:http://localhost:8084}

# Feign Client Configuration
spring.cloud.openfeign:
  client:
    config:
      default:
        connect-timeout: 5000
        read-timeout: 10000
        logger-level: basic
      result-service:
        connect-timeout: 5000
        read-timeout: 10000